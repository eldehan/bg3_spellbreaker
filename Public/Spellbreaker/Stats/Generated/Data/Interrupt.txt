new entry "Spellbreaker_Interrupt_DenyMagic"
type "InterruptData"
data "DisplayName" "hbce9ad05g3237g4cf6g85dcg125f209fc1e4"
data "Description" "hd8b4d37dg7749g4a13gbe85g556c117efe99"
data "DescriptionParams" "LevelMapValue(SpellbaneDie)+WisdomModifier"
data "Icon" "Spellbreaker_Skill_DenyMagic"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and IsSpell() and ((Self(context.Target, context.Observer)) or (Ally(context.Target, context.Observer) and HasPassive('Spellbreaker_DenyMagic_Ally_Passive', context.Observer))) and not Self(context.Source,context.Observer) and not AnyEntityIsItem()"
data "Properties" "IF(Self(context.Target, context.Observer)):AdjustRoll(OBSERVER_OBSERVER,-(LevelMapValue(SpellbaneDie)+WisdomModifier)); IF(Ally(context.Target, context.Observer) and not Self(context.Target, context.Observer)):AdjustRoll(OBSERVER_TARGET,-(LevelMapValue(SpellbaneDie)+WisdomModifier)); IF(HasStatus('SPELLBREAKER_I_ENDURE_STILL_CHANT', context.Observer)):ApplyStatus(OBSERVER_TARGET,SPELLBREAKER_SPELLEATER_HP,100,1);UseSpell(OBSERVER_TARGET,Spellbreaker_Target_DenyMagic_Interrupt,true,true,true)"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

new entry "Spellbreaker_Interrupt_RighteousFerver"
type "InterruptData"
data "DisplayName" "hc5989748gccc1g4f3bga3d7gdf532cd93049"
data "Description" "h0eb4d59agf055g46c1g8277gebfd35518d99"
data "DescriptionParams" "LevelMapValue(SpellbaneDie)"
data "Icon" "Skill_Sorcerer_Passive_BendLuck"
data "InterruptContext" "OnPostRoll"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and not Self(context.Target,context.Observer) and HasInterruptedSavingThrow() and Ally(context.Target, context.Observer) and IsFlatValueInterruptInteresting(8) and not AnyEntityIsItem()"
data "Properties" "AdjustRoll(LevelMapValue(SpellbaneDie)); IF(not Self(context.Target,context.Observer) and HasInterruptedSavingThrow()):UseSpell(OBSERVER_TARGET,Spellbreaker_Target_RighteousFerver_Interrupt,true,true,true)"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "Stack" "Spellbreaker_RighteousFerver"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

new entry "Spellbreaker_Interrupt_CounterspelloLD"
type "InterruptData"
data "DisplayName" "h3bf20f0fge7c6g41cdg8d9bg1623ab403b60"
data "Description" "h71319fe0gc3a5g4854gad6fgb960bb295d9d"
data "DescriptionParams" "1"
data "ExtraDescription" "h49f35f94g3d09g414bgb622gf2b4b9f9bd5b"
data "ExtraDescriptionParams" "1d6"
data "Icon" "Spellbreaker_Skill_DenyMagic"
data "InterruptContext" "OnSpellCast"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and not Self(context.Source, context.Observer) and IsSpell() and not Uninterruptible() and not HasStringInSpellRoll('WeaponAttack') and not AnyEntityIsItem()"
data "Roll" "SpellbreakerTryCounterspellHigherLevel(2)"
data "Success" "Counterspell();UseSpell(OBSERVER_SOURCE,Target_Counterspell_Success,true,true,true);ApplyStatus(SWAP,SPELLBREAKER_ANNULMENT_ANTIMAGIC,100,1); IF(HasStatus('SPELLBREAKER_I_ENDURE_STILL_CHANT', context.Observer)):ApplyStatus(SPELLBREAKER_SPELLEATER_HP,100,-1);"
data "Failure" "UseSpell(OBSERVER_SOURCE,Target_Counterspell_Failure,true,true,true)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "Stack" "Spellbreaker_Interrupt_Counterspell"
data "EnableCondition" "HasStatus('SPELLBREAKER_WITH_IRON_SHIELD_CHANT') or HasStatus('SPELLBREAKER_I_ENDURE_STILL_CHANT') and (not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER'))"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

// NEW

new entry "Spellbreaker_Interrupt_DenyMagic_NEW"
type "InterruptData"
data "DisplayName" "hbce9ad05g3237g4cf6g85dcg125f209fc1e4"
data "Description" "hd8b4d37dg7749g4a13gbe85g556c117efe99"
data "DescriptionParams" "LevelMapValue(SpellbaneDie)"
data "ExtraDescription" "h1ad93c01gb571g4017gbc69g27593dca01d1"
data "Icon" "Spellbreaker_Skill_DenyMagic"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and IsSpell() and ((Self(context.Target, context.Observer)) or (Ally(context.Target, context.Observer) and HasPassive('Spellbreaker_DenyMagic_Ally_Passive', context.Observer))) and not Self(context.Source,context.Observer) and not AnyEntityIsItem()"
data "Properties" "IF(Self(context.Target, context.Observer) and not HasStatus('SPELLBREAKER_DEFENSIVE_CHANT', context.Observer)):AdjustRoll(OBSERVER_OBSERVER,-(LevelMapValue(SpellbaneDie))); IF(Self(context.Target, context.Observer) and HasStatus('SPELLBREAKER_DEFENSIVE_CHANT', context.Observer)):AdjustRoll(OBSERVER_OBSERVER,-(LevelMapValue(SpellbaneDie)+LevelMapValue(SpellbaneDie))); IF(Ally(context.Target, context.Observer) and not Self(context.Target, context.Observer) and not HasStatus('SPELLBREAKER_DEFENSIVE_CHANT', context.Observer)):AdjustRoll(OBSERVER_TARGET,-(LevelMapValue(SpellbaneDie))); IF(Ally(context.Target, context.Observer) and not Self(context.Target, context.Observer) and HasStatus('SPELLBREAKER_DEFENSIVE_CHANT', context.Observer)):AdjustRoll(OBSERVER_TARGET,-(LevelMapValue(SpellbaneDie)+LevelMapValue(SpellbaneDie)));UseSpell(OBSERVER_TARGET,Spellbreaker_Target_DenyMagic_Interrupt,true,true,true)"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

new entry "Spellbreaker_Interrupt_MentalFortress_d4"
type "InterruptData"
data "DisplayName" "hfcf30291g844dg4cedga78dgb0f5beca240b"
data "Description" "ha735cf4bg2e11g4a72g9055g620102f45a60"
data "DescriptionParams" "LevelMapValue(SpellbaneDie)"
data "Icon" "PassiveFeature_IronMind"
data "InterruptContext" "OnPostRoll"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target, context.Observer) and HasInterruptedSavingThrow() and IsFlatValueInterruptInteresting(4) and not AnyEntityIsItem()"
data "Properties" "AdjustRoll(LevelMapValue(SpellbaneDie));"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "Stack" "Spellbreaker_MentalFortress"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

new entry "Spellbreaker_Interrupt_MentalFortress_d6"
type "InterruptData"
using "Spellbreaker_Interrupt_MentalFortress_d4"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target, context.Observer) and HasInterruptedSavingThrow() and IsFlatValueInterruptInteresting(6) and not AnyEntityIsItem()"

new entry "Spellbreaker_Interrupt_MentalFortress_d8"
type "InterruptData"
using "Spellbreaker_Interrupt_MentalFortress_d4"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target, context.Observer) and HasInterruptedSavingThrow() and IsFlatValueInterruptInteresting(8) and not AnyEntityIsItem()"

new entry "Spellbreaker_Interrupt_Counterspell"
type "InterruptData"
data "DisplayName" "h3bf20f0fge7c6g41cdg8d9bg1623ab403b60"
data "Description" "h71319fe0gc3a5g4854gad6fgb960bb295d9d"
data "DescriptionParams" "1"
data "ExtraDescription" "h49f35f94g3d09g414bgb622gf2b4b9f9bd5b"
data "Icon" "Spellbreaker_Skill_DenyMagic"
data "InterruptContext" "OnSpellCast"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and not Self(context.Source, context.Observer) and IsSpell() and not Uninterruptible() and not HasStringInSpellRoll('WeaponAttack') and not AnyEntityIsItem()"
data "Roll" "SpellbreakerTryCounterspellHigherLevel(1)"
data "Success" "Counterspell();UseSpell(OBSERVER_SOURCE,Target_Counterspell_Success,true,true,true);ApplyStatus(SWAP,SPELLBREAKER_ANNULMENT_ANTIMAGIC,50,1);"
data "Failure" "UseSpell(OBSERVER_SOURCE,Target_Counterspell_Failure,true,true,true)"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "Stack" "Spellbreaker_Interrupt_Counterspell"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "Spellbreaker_Interrupt_CounterspellFree"
type "InterruptData"
using "Spellbreaker_Interrupt_CounterspellCost"
data "Success" "Counterspell();UseSpell(OBSERVER_SOURCE,Target_Counterspell_Success,true,true,true);ApplyStatus(SWAP,SPELLBREAKER_ANNULMENT_ANTIMAGIC,100,1); IF(not HasStatus('SPELLBREAKER_USED_FREE_COUNTERSPELL', context.Observer)):ApplyStatus(SPELLBREAKER_USED_FREE_COUNTERSPELL,100,-1);"
data "Failure" "UseSpell(OBSERVER_SOURCE,Target_Counterspell_Failure,true,true,true); IF(not HasStatus('SPELLBREAKER_USED_FREE_COUNTERSPELL', context.Observer)):ApplyStatus(SPELLBREAKER_USED_FREE_COUNTERSPELL,100,-1)"
data "Cost" "ReactionActionPoint:1"

// EVEN NEWER

new entry "Spellbreaker_Interrupt_DenyMagic_NEWER"
type "InterruptData"
data "DisplayName" "h62a22efbga613g452ag9074g0e2714ff5b95"
data "Description" "hd8b4d37dg7749g4a13gbe85g556c117efe99"
data "DescriptionParams" "LevelMapValue(SpellbaneDie)"
data "ExtraDescription" "h1ad93c01gb571g4017gbc69g27593dca01d1"
data "Icon" "Spellbreaker_Skill_DenyMagic"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and IsSpell() and Self(context.Target, context.Observer) and not Self(context.Source,context.Observer) and not AnyEntityIsItem()"
data "Properties" "AdjustRoll(-LevelMapValue(SpellbaneDie)); IF(MainDamageTypeIs(DamageType.Poison)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_POISON_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Radiant)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_RADIANT_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Force)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_FORCE_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Necrotic)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_NECROTIC_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Psychic)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_PSYCHIC_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Acid)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_ACID_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Cold)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_COLD_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Fire)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_FIRE_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Lightning)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_LIGHTNING_DAMAGE, 100, 2); IF(MainDamageTypeIs(DamageType.Thunder)):ApplyStatus(OBSERVER_TARGET, SPELLBREAKER_DENY_MAGIC_THUNDER_DAMAGE, 100, 2); UseSpell(OBSERVER_TARGET,Spellbreaker_Target_DenyMagic_Interrupt,true,true,true)"
data "Cost" "ReactionActionPoint:1;SpellbaneDie:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"